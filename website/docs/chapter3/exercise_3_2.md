---
sidebar_position: 3
---

# Exercise 3.2

まず、$h(x)$を$c(x)$を用いて表すと
$$
h(x) = \left\{
\begin{array}{ll}
\text{mix}(0.3, 0.9, c(x+1)) = 0.3 + 0.6 c(x+1) & (-1 \leq x \leq 0)\\
\text{mix}(0.9, 0.6, c(x)) = 0.9 - 0.3 c(x) & (0 \leq x \leq 1)
\end{array}
\right.
$$
であるため、$h(x)$が$[-1, 1]$区間上で$C^3$級となるには、$c(x)$として$[0, 1]$区間上で$C^3$級な補間関数であり、かつ補間する各点(ここでは$(0,0)$と$(1,1)$)で導関数$c'$, $c''$, $c'''$らの値がそれぞれ$0$となるものが見つかれば良い。

これを言い換えると、以下の8つの等式を満たす$c(x)$を導き出せば良い、ということである。
8つの等式とは、補間関数の定義から得られる
$$
\tag{ex3.2.1} c(0)=0, c(1)=1
$$
と、各導関数と補間点の関係から得られる
$$
\tag{ex3.2.2} 
\begin{array}{c}
c'(0)=0, c'(1)=0 \\
c''(0)=0, c''(1)=0 \\ 
c'''(0)=0, c'''(1)=0 
\end{array}

$$
らを指す。

さて、得られた等式は8つあるので、多項式$c(x)$を求めるにあたり、8つの係数を持った7次の多項式から始めたい。つまり$c(x)$が下記の様に表現できたとして、各$a_n$の値を求めたい。
$$
c(x) = a_7 x^7 + a_6 x^6 + a_5 x^5 + a_4 x^4 + a_3 x^3 + a_2 x^2 + a_1 x + a_0 
$$

まず、(ex3.2.1)式から、
$$
c(0) = 0 + 0 + 0 + 0 + 0 + 0 + 0 + a_0 = 0 \\
c(1) = a_7 + a_6 + a_5 + a_4 + a_3 + a_2 + a_1 + a_0 = 1
$$
を得る。次に、各種導関数も$a_n$を使って記載すると、
$$
c'(x)= 7 a_7 x^6 + 6 a_6 x^5 + 5 a_5 x^4 + 4 a_4 x^3 + 3 a_3 x^2 + 2 a_2 x + a_1 \\
c''(x)= 42 a_7 x^5 + 30 a_6 x^4 + 20 a_5 x^3 + 12 a_4 x^2 + 6 a_3 x + 2 a_2 \\
c'''(x)= 210 a_7 x^4 + 120 a_6 x^3 + 60 a_5 x^2 + 24 a_4 x + 6 a_3
$$
であるので(ex3.2.2)式より、
$$
c'(0) = 0 + 0 + 0 + 0 + 0 + 0 + a_1 = 0 \\
c'(1) = 7 a_7 + 6 a_6 + 5 a_5+ 4 a_4 + 3 a_3 + 2 a_2 + a_1 = 0 \\
$$
$$
c''(0) = 0 + 0 + 0 + 0 + 0 + a_2 = 0 \\
c''(1) = 42 a_7+ 30 a_6+ 20 a_5 + 12 a_4 + 6 a_3 + 2 a_2 = 0 \\
$$
$$
c'''(0) = 0 + 0 + 0 + 0 + a_3 = 0 \\
c'''(1) = 210 a_7 + 120 a_6 + 60 a_5 + 24 a_4 + 6 a_3 = 0
$$
らを得る。$a_0=a_1=a_2=a_3=0$は自明なので、後は4元連立方程式
$$
\begin{pmatrix}
1    & 1    & 1  & 1   \\
7    & 6    & 5  & 4   \\
42   & 30   & 20 & 12 \\
210  & 120  & 60 & 24 \\
\end{pmatrix}
\begin{pmatrix}
a_7 \\
a_6 \\
a_5 \\
a_4 \\
\end{pmatrix}
=
\begin{pmatrix}
1 \\
0 \\
0 \\
0 \\
\end{pmatrix}
$$
を解いて、$a_7 = -20, a_6 = 70, a_5 = - 84, a_4 = 35$を得ることができ、結果として、
$$
c(x) = -20 x^7 + 70 x^6 - 84 x^5 + 35 x^4
$$
を得る。(なお、$c(x)$のグラフを描画すると[こちら](https://ja.wolframalpha.com/input?i=-20+x%5E7+%2B+70+x%5E6+-+84+x%5E5+%2B+35+x%5E4%E3%81%AE%E3%82%B0%E3%83%A9%E3%83%95%E3%82%92%E4%BD%9C%E6%88%90)の様になります。)

さて、確認のため、この$c(x)$を使って$h(x)$を書きなおしてみると
$$
h(x) = \left\{
\begin{array}{ll}
\text{mix}(0.3, 0.9, c(x+1)) = 0.9 - 21 x^4 - 50.4 x^5 - 42 x^6 - 12 x^7  & (-1 \leq x \leq 0)\\
\text{mix}(0.9, 0.6, c(x)) = 0.9 - 10.5 x^4 + 25.2 x^5 - 21 x^6 + 6 x^7 & (0 \leq x \leq 1)
\end{array}
\right.
$$
となるが、この$h(x)$の3次導関数は
$$
h'''(x) = \left\{
\begin{array}{ll}
-504 x (1 + 6 x + 10 x^2 + 5 x^3)  & (-1 \leq x \leq 0)\\
252 x (-1 + 6 x - 10 x^2 + 5 x^3) & (0 \leq x \leq 1)
\end{array}
\right.
$$
と存在し、かつ$x = 0$で連続となるため、$h(x)$は$C^3$級であることがわかる。

以上をまとめると、
$c(x)$として、7次関数
$$
-20 x^7 + 70 x^6 - 84 x^5 + 35 x^4
$$
をとると、$h(x)$は$C^3$級となることができる。
